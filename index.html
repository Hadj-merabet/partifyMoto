<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Partify Moto ‚Äì Pi√®ces moto</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>

<style>
body{font-family:Inter,system-ui}
.filter-btn.active{background:#ea580c;color:white}
</style>
</head>

<body class="bg-slate-50 text-slate-800">

<!-- HEADER -->
<header class="bg-white shadow p-6 flex justify-between items-center">
  <div>
    <h1 class="text-3xl font-bold">PARTIFY MOTO</h1>
    <p class="text-slate-500">Car√©nages ¬∑ Freinage ¬∑ Moteur</p>
  </div>
  <button onclick="openCart()" class="relative bg-orange-600 text-white px-4 py-2 rounded">
    Panier (<span id="cartCount">0</span>)
  </button>
</header>

<!-- SEARCH -->
<section class="max-w-4xl mx-auto p-6 bg-white mt-6 rounded shadow">
  <div class="grid grid-cols-3 gap-3">
    <select id="brand" class="p-3 border rounded">
      <option value="">Marque</option>
      <option>Yamaha</option>
      <option>Honda</option>
    </select>
    <select id="model" class="p-3 border rounded">
      <option value="">Mod√®le</option>
    </select>
    <select id="year" class="p-3 border rounded">
      <option value="">Ann√©e</option>
    </select>
  </div>

  <button id="searchBtn" class="mt-4 w-full bg-orange-600 text-white p-3 rounded">
    Trouver mes pi√®ces
  </button>
</section>

<!-- FILTER -->
<section id="filters" class="max-w-6xl mx-auto px-6 mt-6 hidden">
  <div class="flex gap-2">
    <button data-cat="all" class="filter-btn active border px-3 py-1 rounded">Tous</button>
    <button data-cat="carenage" class="filter-btn border px-3 py-1 rounded">Car√©nages</button>
    <button data-cat="freinage" class="filter-btn border px-3 py-1 rounded">Freinage</button>
    <button data-cat="moteur" class="filter-btn border px-3 py-1 rounded">Moteur</button>
  </div>
</section>

<!-- RESULTS -->
<section id="results" class="max-w-6xl mx-auto px-6 grid md:grid-cols-3 gap-6 mt-6"></section>

<!-- PANIER -->
<div id="cartModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center">
  <div class="bg-white w-full max-w-lg p-6 rounded shadow">
    <h2 class="text-xl font-bold mb-4">Votre panier</h2>

    <div id="cartItems" class="space-y-3"></div>

    <div class="flex justify-between mt-4 font-bold">
      <span>Total</span>
      <span id="cartTotal">0 ‚Ç¨</span>
    </div>

    <div class="mt-4 flex gap-2">
      <button onclick="closeCart()" class="flex-1 border p-2 rounded">Continuer</button>
      <button onclick="checkout()" class="flex-1 bg-orange-600 text-white p-2 rounded">
        Commander
      </button>
    </div>
  </div>
</div>

<script>
/* DATA */
const models = {
  Yamaha:["PW50","YZ85","YZ125","YZ250","YZ450F"],
  Honda:["CRF50","CRF125"]
};
const years = Array.from({length:10},(_,i)=>2025-i);
let cart = [];

/* IMAGES 3D NEUTRES (L√âGALES) */
function productImage(cat,title){
  const icons={
    carenage:"üü¶",
    freinage:"üõë",
    moteur:"‚öôÔ∏è"
  };

  return `data:image/svg+xml;utf8,
  <svg xmlns='http://www.w3.org/2000/svg' width='800' height='500'>
    <defs>
      <linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>
        <stop offset='0%' stop-color='%23e2e8f0'/>
        <stop offset='100%' stop-color='%23f8fafc'/>
      </linearGradient>
    </defs>

    <rect width='100%' height='100%' fill='url(%23g)'/>
    <rect x='120' y='140' rx='40' ry='40' width='560' height='220' fill='%23cbd5f5'/>

    <text x='50%' y='45%' font-size='72' text-anchor='middle'>${icons[cat]}</text>
    <text x='50%' y='65%' font-size='26' text-anchor='middle' fill='%230f172a'>${title}</text>
    <text x='50%' y='72%' font-size='16' text-anchor='middle' fill='%2364748b'>Visuel 3D non contractuel</text>
  </svg>`;
}

/* DOM */
const brand=document.getElementById("brand");
const model=document.getElementById("model");
const year=document.getElementById("year");
const results=document.getElementById("results");
const filters=document.getElementById("filters");

/* EVENTS */
brand.onchange=()=>{
  model.innerHTML="<option value=''>Mod√®le</option>";
  models[brand.value]?.forEach(m=>model.innerHTML+=`<option>${m}</option>`);
  year.innerHTML="<option value=''>Ann√©e</option>";
  years.forEach(y=>year.innerHTML+=`<option>${y}</option>`);
};

document.getElementById("searchBtn").onclick=()=>{
  if(!brand.value||!model.value||!year.value){
    alert("S√©lectionne marque, mod√®le et ann√©e");
    return;
  }

  results.innerHTML="";
  filters.classList.remove("hidden");

  const products=[
    {cat:"carenage",title:"Car√©nage origine",price:219},
    {cat:"carenage",title:"Car√©nage premium",price:109},
    {cat:"freinage",title:"Plaquettes frein origine",price:34},
    {cat:"freinage",title:"Plaquettes frein premium",price:44},
    {cat:"moteur",title:"Piston moteur",price:89},
    {cat:"moteur",title:"Cylindre moteur",price:219}
  ];

  products.forEach(p=>{
    results.innerHTML+=`
    <div class="product bg-white p-4 rounded shadow" data-cat="${p.cat}">
      <img src="${productImage(p.cat,p.title)}" class="w-full h-40 rounded object-cover">
      <h3 class="mt-2 font-semibold">${p.title}</h3>
      <p class="text-sm text-slate-500">${brand.value} ${model.value} ${year.value}</p>
      <p class="text-orange-600 font-bold">${p.price} ‚Ç¨</p>

      <select class="qty mt-2 border p-2 w-full rounded">
        ${[1,2,3,4,5].map(n=>`<option>${n}</option>`).join("")}
      </select>

      <button class="addCart mt-2 w-full bg-orange-600 text-white p-2 rounded">
        Ajouter au panier
      </button>
    </div>`;
  });

  document.querySelectorAll(".addCart").forEach((btn,i)=>{
    btn.onclick=()=>{
      const q=document.querySelectorAll(".qty")[i].value;
      addToCart(products[i],q);
    };
  });
};

/* PANIER */
function addToCart(p,qty){
  cart.push({...p,qty:Number(qty)});
  updateCart();
}

function updateCart(){
  document.getElementById("cartCount").textContent=
    cart.reduce((a,b)=>a+b.qty,0);

  const box=document.getElementById("cartItems");
  box.innerHTML="";
  let total=0;

  cart.forEach((i,idx)=>{
    total+=i.price*i.qty;
    box.innerHTML+=`
    <div class="flex justify-between items-center">
      <div>
        <p class="font-semibold">${i.title}</p>
        <p class="text-sm">${i.qty} √ó ${i.price} ‚Ç¨</p>
      </div>
      <button onclick="removeItem(${idx})" class="text-red-500">‚úï</button>
    </div>`;
  });

  document.getElementById("cartTotal").textContent=total+" ‚Ç¨";
}

function removeItem(i){
  cart.splice(i,1);
  updateCart();
}

function openCart(){
  document.getElementById("cartModal").classList.remove("hidden");
}
function closeCart(){
  document.getElementById("cartModal").classList.add("hidden");
}

function checkout(){
  alert("Paiement Stripe √† venir üöÄ");
}
</script>

</body>
</html>
