<!doctype html>
<html lang="fr" class="scroll-smooth"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partify Moto – Pièces &amp; Actualités</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;family=Space+Grotesk:wght@500;600;700&amp;display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Iconify -->
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#fff7ed',
                            100: '#ffedd5',
                            500: '#f97316',
                            600: '#ea580c',
                            900: '#7c2d12',
                        },
                        slate: {
                            850: '#1e293b',
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        select { -webkit-appearance: none; -moz-appearance: none; appearance: none; }
        
        .fade-in { animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .toast { animation: slideIn 0.3s ease-out forwards; }
        @keyframes slideIn { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Modal Overlay */
        .modal-overlay { background-color: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); }
    </style>
</head>
<body class="bg-white text-slate-600 font-sans antialiased selection:bg-brand-100 selection:text-brand-600 flex flex-col min-h-screen relative">

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-[70] flex flex-col gap-2 pointer-events-none"></div>

    <!-- PRODUCT DETAIL MODAL (Hidden by default) -->
    <div id="product-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0 transition-opacity" onclick="closeModal()"></div>
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative z-10 flex flex-col md:flex-row fade-in">
            <button onclick="closeModal()" class="absolute top-4 right-4 p-2 bg-slate-100 rounded-full hover:bg-slate-200 z-20">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            
            <!-- Image Side -->
            <div class="w-full md:w-1/2 bg-slate-50 p-8 flex items-center justify-center border-b md:border-b-0 md:border-r border-slate-100">
                <img id="modal-img" src="" alt="Photo produit" class="max-w-full max-h-[400px] object-contain">
            </div>
            
            <!-- Info Side -->
            <div class="w-full md:w-1/2 p-8 flex flex-col">
                <div class="mb-6">
                    <span id="modal-brand" class="text-xs font-bold text-brand-600 uppercase tracking-wider bg-brand-50 px-2 py-1 rounded border border-brand-100">Marque</span>
                    <h2 id="modal-title" class="font-display text-3xl font-bold text-slate-900 mt-3 mb-2">Titre Produit</h2>
                    <p id="modal-ref" class="text-sm text-slate-400 font-mono">REF: 0000</p>
                </div>

                <div class="bg-blue-50 border border-blue-100 rounded-lg p-4 mb-6 flex gap-3 items-start hidden" id="modal-compatibility-box">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 mt-0.5"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <div>
                        <h4 class="font-bold text-blue-900 text-sm">Compatibilité Vérifiée</h4>
                        <p class="text-xs text-blue-700 mt-1">Ce produit est confirmé compatible avec votre <span id="modal-bike-name" class="font-semibold">Moto</span>.</p>
                    </div>
                </div>

                <div class="prose prose-sm text-slate-500 mb-6 flex-grow">
                    <h4 class="text-slate-900 font-semibold mb-2">Description</h4>
                    <p id="modal-desc">Description détaillée...</p>
                    <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs not-prose">
                        <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
                            <p class="text-slate-400 uppercase tracking-wide text-[10px]">Fournisseur</p>
                            <a id="modal-supplier" href="#" target="_blank" rel="noopener" class="text-slate-900 font-semibold hover:text-brand-600">Nom fournisseur</a>
                            <a id="modal-supplier-product" href="#" target="_blank" rel="noopener" class="block mt-1 text-[11px] text-brand-600 hover:underline">Voir la fiche fournisseur</a>
                        </div>
                        <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
                            <p class="text-slate-400 uppercase tracking-wide text-[10px]">Délai livraison réel</p>
                            <p id="modal-delivery" class="text-slate-900 font-semibold">3 à 5 jours ouvrés</p>
                        </div>
                    </div>
                    <h4 class="text-slate-900 font-semibold mt-4 mb-2">Caractéristiques Techniques</h4>
                    <ul id="modal-specs" class="list-disc pl-4 space-y-1">
                        <!-- Specs injected here -->
                    </ul>
                </div>

                <div class="flex items-center justify-between border-t border-slate-100 pt-6 mt-auto">
                    <div class="flex flex-col">
                        <span class="text-slate-400 text-xs">Prix unitaire</span>
                        <span id="modal-price" class="font-display text-3xl font-bold text-slate-900">00,00 €</span>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-3 items-stretch">
                    <a id="modal-order-supplier" href="#" target="_blank" rel="noopener" class="bg-white border border-slate-300 hover:border-brand-500 text-slate-700 hover:text-brand-600 font-medium px-5 py-4 rounded-xl transition-all text-sm text-center">Commander chez fournisseur</a>
                    <button id="modal-add-btn" class="bg-slate-900 hover:bg-brand-600 text-white font-medium px-8 py-4 rounded-xl transition-all shadow-lg hover:shadow-brand-500/20 flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                        Ajouter au panier
                    </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 w-full z-50 bg-white/95 backdrop-blur-md border-b border-slate-200/60 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between gap-8">
            <!-- Logo -->
            <a href="javascript:void(0)" onclick="navigateTo('home')" class="flex items-center gap-2 group cursor-pointer flex-shrink-0">
                <div class="w-8 h-8 bg-slate-900 rounded-lg flex items-center justify-center text-white group-hover:bg-brand-600 transition-colors duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:zap" data-stroke-width="1.5" class="iconify iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"></path></svg>
                </div>
                <span class="font-display font-bold text-lg tracking-tight text-slate-900 uppercase hidden sm:block">Partify</span>
            </a>
            
            <!-- Global Search Bar -->
            <div class="hidden md:flex flex-grow max-w-md relative">
                <input type="text" id="global-search" onkeyup="handleGlobalSearch(event)" placeholder="Rechercher : Piston, Kit Chaine, Guidon..." class="w-full bg-slate-100 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 block pl-10 p-2.5 outline-none transition-all placeholder:text-slate-400">
                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:search" data-stroke-width="1.5" class="iconify absolute left-3 top-3 text-slate-400 iconify--lucide"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m21 21l-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></g></svg>
            </div>

            <!-- Links & Cart -->
            <div class="flex items-center gap-6">
                <div class="hidden md:flex items-center gap-6 text-sm font-medium">
                    <a href="javascript:void(0)" onclick="navigateTo('home')" class="hover:text-slate-900 transition-colors text-slate-500">Accueil</a>
                    <a href="javascript:void(0)" onclick="navigateTo('catalog')" class="text-slate-500 hover:text-brand-600 transition-colors">Catalogue</a>
                    <a href="javascript:void(0)" onclick="navigateTo('news')" class="text-slate-500 hover:text-brand-600 transition-colors flex items-center gap-1">Actualités <span class="w-1.5 h-1.5 rounded-full bg-red-500"></span></a>
                </div>

                <div class="flex items-center gap-4">
                    <button onclick="navigateTo('cart')" class="p-2 text-slate-500 hover:text-slate-900 relative group transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:shopping-bag" data-stroke-width="1.5" class="iconify w-5 h-5 iconify--lucide"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 10a4 4 0 0 1-8 0M3.103 6.034h17.794"></path><path d="M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z"></path></g></svg>
                        <span id="cart-count" class="absolute top-0 right-0 w-4 h-4 bg-brand-600 text-white text-[10px] font-bold rounded-full flex items-center justify-center opacity-0 transition-opacity">0</span>
                    </button>
                    <!-- User Profile / Garage Status -->
                    <div id="user-garage-status" class="hidden sm:flex items-center gap-2 text-xs font-semibold bg-slate-100 text-slate-600 px-3 py-2 rounded-lg border border-slate-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
                        Garage
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- PAGE: HOME -->
    <main id="page-home" class="fade-in pt-16 flex-grow block">
        <!-- Hero Section -->
        <header class="lg:pt-24 lg:pb-32 overflow-hidden pt-12 pb-20 relative">
            <div class="absolute top-0 right-0 -mr-20 -mt-20 w-[600px] h-[600px] bg-brand-50 rounded-full blur-3xl opacity-50 -z-10"></div>

            <div class="grid lg:grid-cols-2 lg:gap-20 max-w-7xl mr-auto ml-auto pr-6 pl-6 gap-x-12 gap-y-12 items-center">
                <div class="max-w-2xl z-10">
                    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-slate-100 border border-slate-200 text-xs font-medium text-slate-600 mb-6">
                        <span class="flex h-2 w-2 rounded-full bg-brand-500 animate-pulse"></span>
                        Promo : Kit Carénages Adaptables -30%
                    </div>
                    <h1 class="font-display text-4xl lg:text-6xl font-bold text-slate-900 tracking-tight leading-[1.1] mb-6">
                        Pièces Origine &amp; <br><span class="text-brand-600">Adaptables</span>.
                    </h1>
                    <p class="text-lg text-slate-500 leading-relaxed mb-8 max-w-lg font-light">
                        Configurez votre moto dans le garage virtuel pour être sûr de la compatibilité à 100%. Cross, Enduro et Route.
                    </p>

                    <!-- Search Widget (Brand/Model/Year) -->
                    <div class="bg-white p-3 rounded-xl border border-slate-200 shadow-xl shadow-slate-200/40 max-w-lg">
                        <div class="grid grid-cols-3 gap-2 mb-2">
                            <!-- Brand -->
                            <div class="relative col-span-3 sm:col-span-1">
                                <select id="hero-brand" onchange="updateModels('hero')" class="focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 block outline-none cursor-pointer transition-all text-sm font-medium text-slate-900 bg-slate-50 w-full border-slate-200 border rounded-lg pt-3 pr-8 pb-3 pl-3">
                                    <option value="">Marque...</option>
                                    <!-- Populated by JS -->
                                </select>
                                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:chevron-down" class="iconify absolute right-2 top-3.5 text-slate-400 pointer-events-none iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"></path></svg>
                            </div>
                            <!-- Model -->
                            <div class="relative col-span-3 sm:col-span-1">
                                <select id="hero-model" disabled="" class="w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm font-medium rounded-lg focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 block p-3 pr-8 outline-none cursor-pointer transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                                    <option value="">Modèle...</option>
                                </select>
                                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:chevron-down" class="iconify absolute right-2 top-3.5 text-slate-400 pointer-events-none iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"></path></svg>
                            </div>
                            <!-- Year -->
                            <div class="relative col-span-3 sm:col-span-1">
                                <select id="hero-year" class="w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm font-medium rounded-lg focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 block p-3 pr-8 outline-none cursor-pointer transition-all">
                                    <option>Année...</option>
                                    <option>2024</option>
                                    <option>2023</option>
                                    <option>2022</option>
                                    <option>2021</option>
                                    <option>2020</option>
                                    <option>2019</option>
                                    <option>2018</option>
                                    <option>2017</option>
                                    <option>2016</option>
                                    <option>2015</option>
                                </select>
                                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:chevron-down" class="iconify absolute right-2 top-3.5 text-slate-400 pointer-events-none iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6 9l6 6l6-6"></path></svg>
                            </div>
                        </div>
                        <button onclick="setGarageFromHero()" class="w-full bg-slate-900 hover:bg-slate-800 text-white font-semibold py-3.5 px-6 rounded-lg transition-all flex items-center justify-center gap-2 group text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:wrench" data-stroke-width="1.5" class="iconify iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg>
                            Ajouter au Garage &amp; Voir les pièces
                        </button>
                    </div>
                </div>

                <!-- Visual Composition -->
                <div class="relative grid grid-cols-2 gap-4">
                    <div class="space-y-4 translate-y-8">
                        <div class="rounded-2xl overflow-hidden shadow-lg border border-slate-100 aspect-[3/4] relative group">
                            <div class="bg-gradient-to-t from-black/40 to-transparent z-10 absolute top-0 right-0 bottom-0 left-0"></div>
                            <img src="https://azwecdnepstoragewebsiteuploads.azureedge.net/PHO_BIKE_90_RE_KTM-motocross-250-sxf-factory-edition-right-side-view_%23SALL_%23AEPI_%23V1.png?w=800&amp;q=80" alt="Motocross Action" class="object-cover w-full h-full transform group-hover:scale-105 transition-transform duration-700">
                            <div class="absolute bottom-4 left-4 z-20">
                                <span class="text-white font-display font-bold text-lg drop-shadow-md">Motocross</span>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="rounded-2xl overflow-hidden shadow-lg border border-slate-100 aspect-[3/4] relative group">
                            <div class="bg-gradient-to-t from-black/40 to-transparent z-10 absolute top-0 right-0 bottom-0 left-0"></div>
                            <img src="https://lonerider.com/cdn/shop/articles/Yamaha-Tenere-700-Extreme-Edition_1000x.jpg?w=800&amp;q=80" alt="Adventure Bike" class="object-cover w-full h-full transform group-hover:scale-105 transition-transform duration-700" style="outline: rgb(245, 158, 11) solid 2px; outline-offset: 2px; transition: outline 0.1s ease-in-out;">
                            <div class="absolute bottom-4 left-4 z-20">
                                <span class="text-white font-display font-bold text-lg drop-shadow-md">Adventure</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Collections -->
        <section class="border-y bg-slate-50 border-slate-200 pt-16 pb-16">
            <div class="max-w-7xl mx-auto px-6">
                <div class="flex mb-8 items-end justify-between">
                    <h2 class="font-display text-2xl font-bold text-slate-900 tracking-tight">Univers Pilote</h2>
                    <button onclick="navigateTo('catalog')" class="text-brand-600 text-sm font-medium hover:text-brand-700 flex items-center gap-1 transition-colors">
                        Tout voir <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:arrow-right" data-stroke-width="1.5" class="iconify iconify--lucide"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7-7l7 7l-7 7"></path></svg>
                    </button>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
                    <div onclick="filterCatalogCategory('Carénage'); navigateTo('catalog')" class="group cursor-pointer relative rounded-xl overflow-hidden h-64 shadow-sm border border-slate-200">
                        <img src="https://kitdeco-moto.fr/wp-content/uploads/2024/03/kit-deco-yamaha-85-yz-2022-2024-monster-scaled.webp?w=800&amp;q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Carénage" style="">
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/20 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-4 w-full">
                            <h3 class="font-display font-semibold text-white text-lg mb-0.5">Carénages</h3>
                            <p class="text-slate-300 text-xs font-light">Kits Plastiques &amp; Déco</p>
                        </div>
                    </div>
                    <div onclick="filterCatalogCategory('Moteur'); navigateTo('catalog')" class="group cursor-pointer relative rounded-xl overflow-hidden h-64 shadow-sm border border-slate-200">
                        <img src="https://images.unsplash.com/photo-1568772585407-9361f9bf3a87?q=80&amp;w=800&amp;auto=format&amp;fit=crop" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Moteur">
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/20 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-4 w-full">
                            <h3 class="font-display font-semibold text-white text-lg mb-0.5">Moteur</h3>
                            <p class="text-slate-300 text-xs font-light">Pistons, Filtres</p>
                        </div>
                    </div>
                    <div onclick="filterCatalogCategory('Cycle'); navigateTo('catalog')" class="group cursor-pointer relative rounded-xl overflow-hidden h-64 shadow-sm border border-slate-200">
                        <img src="https://www.wdracing.eu/58816-large_default/oem-cylindre-fantic-xx-125-21-xe-125-21-22-yamaha-yz-125-05-21.webp?w=800&amp;q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Pneus">
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/20 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-4 w-full">
                            <h3 class="font-display font-semibold text-white text-lg mb-0.5">Cycle</h3>
                            <p class="text-slate-300 text-xs font-light">Pneus, Freins, Chaînes</p>
                        </div>
                    </div>
                    <div onclick="filterCatalogCategory('Protection'); navigateTo('catalog')" class="group cursor-pointer relative rounded-xl overflow-hidden h-64 shadow-sm border border-slate-200">
                        <img src="https://images.unsplash.com/photo-1558981403-c5f9899a28bc?q=80&amp;w=800&amp;auto=format&amp;fit=crop" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Equipement">
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/20 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-4 w-full">
                            <h3 class="font-display font-semibold text-white text-lg mb-0.5">Protection</h3>
                            <p class="text-slate-300 text-xs font-light">Sabots, Guidons</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- PAGE: NEWS (Actualités) -->
    <main id="page-news" class="hidden pt-16 flex-grow bg-white">
        <div class="bg-slate-900 text-white py-16 relative overflow-hidden">
            <div class="max-w-7xl mx-auto px-6 relative z-10">
                <span class="text-brand-500 font-bold uppercase tracking-wider text-xs mb-2 block">Partify Magazine</span>
                <h1 class="font-display text-4xl md:text-5xl font-bold mb-4">Actualité Moto &amp; Compétition</h1>
                <p class="text-slate-300 max-w-2xl text-lg">Suivez les dernières sorties, les résultats MXGP/EnduroGP et nos guides techniques.</p>
            </div>
        </div>
        
        <div class="max-w-7xl mx-auto px-6 py-12">
            <div id="news-grid" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- News items populated by JS -->
            </div>
        </div>
    </main>

    <!-- PAGE: CATALOG -->
    <main id="page-catalog" class="hidden pt-16 flex-grow bg-slate-50/50">
        <!-- Catalog Header -->
        <div class="bg-white border-b border-slate-200 pt-10 pb-6">
            <div class="max-w-7xl mx-auto px-6">
                <div class="flex items-center gap-2 text-xs font-medium text-slate-400 mb-4">
                    <span onclick="navigateTo('home')" class="cursor-pointer hover:text-slate-900 transition-colors">Accueil</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="iconify"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    <span class="text-slate-900">Catalogue</span>
                </div>
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                    <div>
                        <h1 class="font-display text-3xl font-bold text-slate-900 tracking-tight">Catalogue Pièces</h1>
                        <p class="text-sm text-slate-500 mt-2" id="catalog-subtitle">Toutes nos références disponibles</p>
                        <p class="text-xs text-slate-400 mt-2">Sourcing dropshipping via grossistes moto UE (Bihr, Parts Europe, KRM, Wemoto, Tripleclamp).</p>
                        <p class="text-xs text-slate-400 mt-1">Photos produits sous licence éditoriale/stock affichées temporairement. Remplacer par photos officielles fournisseur (avec accord écrit) avant mise en production.</p>
                        <p class="text-xs text-slate-400 mt-1">Photos produits issues de catalogues marque/fournisseur. Vérifiez les droits d'utilisation selon vos accords revendeur avant diffusion commerciale.</p>
                        <div class="mt-3 flex flex-wrap gap-2">
                            <button onclick="exportShopifyCsv()" class="text-xs px-3 py-1.5 rounded border border-slate-300 hover:border-brand-500 hover:text-brand-600">Exporter CSV Shopify</button>
                            <a href="https://apps.shopify.com/search?q=dropshipping" target="_blank" rel="noopener" class="text-xs px-3 py-1.5 rounded border border-slate-300 hover:border-brand-500 hover:text-brand-600">Apps dropshipping Shopify</a>
                            <button onclick="exportSupplierJson()" class="text-xs px-3 py-1.5 rounded border border-slate-300 hover:border-brand-500 hover:text-brand-600">Exporter JSON fournisseurs</button>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-3">
                        <select id="sort-select" onchange="renderCatalog()" class="bg-slate-50 border border-slate-200 text-sm font-medium rounded-lg px-4 py-2.5 pr-8 focus:ring-1 focus:ring-brand-500 outline-none cursor-pointer">
                            <option value="relevance">Pertinence</option>
                            <option value="price-asc">Prix croissant</option>
                            <option value="price-desc">Prix décroissant</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-6 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                
                <!-- Filters Sidebar -->
                <aside class="hidden lg:block space-y-8 h-fit sticky top-24">
                    <!-- My Garage Widget -->
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <h3 class="font-display font-semibold text-slate-900 mb-4 text-sm uppercase tracking-wide flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path><circle cx="7" cy="17" r="2"></circle><circle cx="17" cy="17" r="2"></circle><path d="M2 12h12"></path></svg>
                            Mon Garage
                        </h3>
                        
                        <div id="garage-empty" class="text-center py-4">
                            <p class="text-xs text-slate-500 mb-3">Aucune moto sélectionnée.</p>
                            <button onclick="document.getElementById('garage-selector').classList.remove('hidden'); this.classList.add('hidden')" class="w-full py-2 border border-dashed border-slate-300 rounded text-xs font-medium text-slate-500 hover:border-brand-500 hover:text-brand-600 transition-colors">
                                + Ajouter une moto
                            </button>
                        </div>

                        <div id="garage-active" class="hidden bg-brand-50 rounded-lg border border-brand-100 p-3 mb-2">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span class="text-xs font-bold text-brand-600 uppercase block mb-0.5" id="garage-brand-display">YAMAHA</span>
                                    <span class="text-sm font-semibold text-slate-900 block" id="garage-model-display">Ténéré 700</span>
                                    <span class="text-xs text-slate-500" id="garage-year-display">2022</span>
                                </div>
                                <button onclick="clearGarage()" class="text-slate-400 hover:text-red-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                                </button>
                            </div>
                            <div class="mt-2 pt-2 border-t border-brand-200/50 flex items-center gap-1 text-[10px] text-brand-700 font-medium">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                Compatibilité active
                            </div>
                        </div>

                        <!-- Mini Selector (Hidden initially) -->
                        <div id="garage-selector" class="hidden space-y-2 mt-2">
                            <select id="sidebar-brand" onchange="updateModels('sidebar')" class="w-full text-xs bg-slate-50 border border-slate-200 rounded p-2"><option value="">Marque</option></select>
                            <select id="sidebar-model" disabled="" class="w-full text-xs bg-slate-50 border border-slate-200 rounded p-2"><option value="">Modèle</option></select>
                            <select id="sidebar-year" class="w-full text-xs bg-slate-50 border border-slate-200 rounded p-2"><option value="">Année</option><option>2024</option><option>2023</option><option>2022</option><option>2020</option></select>
                            <button onclick="setGarageFromSidebar()" class="w-full bg-slate-900 text-white text-xs py-2 rounded font-medium">Valider</button>
                        </div>
                    </div>

                    <!-- Category Filter -->
                    <div>
                        <h3 class="font-display font-semibold text-slate-900 mb-4 text-sm uppercase tracking-wide">Catégories</h3>
                        <div class="space-y-2" id="category-filters">
                            <!-- Injected via JS -->
                        </div>
                    </div>
                </aside>

                <!-- Products Grid -->
                <div class="col-span-1 lg:col-span-3">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="product-grid">
                        <!-- Products injected via JS -->
                    </div>
                    <div id="no-results" class="hidden text-center py-12">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100 text-slate-400 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        </div>
                        <h3 class="text-lg font-medium text-slate-900">Aucun produit trouvé</h3>
                        <p class="text-slate-500">Essayez de modifier vos filtres ou votre recherche.</p>
                        <button onclick="resetFilters()" class="mt-4 text-brand-600 font-medium hover:underline">Voir tout le catalogue</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- PAGE: CART -->
    <main id="page-cart" class="hidden pt-16 flex-grow bg-slate-50/50">
        <div class="max-w-4xl mx-auto px-6 py-12">
            <h1 class="font-display text-3xl font-bold text-slate-900 mb-8 flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:shopping-cart" class="iconify iconify--lucide"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="8" cy="21" r="1"></circle><circle cx="19" cy="21" r="1"></circle><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"></path></g></svg> 
                Mon Panier
            </h1>

            <div id="cart-empty-state" class="hidden text-center py-20 bg-white rounded-2xl border border-slate-200 shadow-sm">
                <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="1em" height="1em" viewBox="0 0 24 24" data-icon="lucide:shopping-bag" class="iconify w-8 h-8 iconify--lucide"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 10a4 4 0 0 1-8 0M3.103 6.034h17.794"></path><path d="M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z"></path></g></svg>
                </div>
                <h3 class="text-lg font-medium text-slate-900 mb-2">Votre panier est vide</h3>
                <button onclick="navigateTo('catalog')" class="mt-4 bg-slate-900 text-white px-6 py-3 rounded-lg font-medium hover:bg-brand-600 transition-colors">
                    Aller au catalogue
                </button>
            </div>

            <div id="cart-content" class="grid grid-cols-1 lg:grid-cols-3 gap-8 hidden">
                <div class="lg:col-span-2 space-y-4" id="cart-items-container"></div>
                <div class="lg:col-span-1 h-fit">
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm sticky top-24">
                        <h3 class="font-display font-semibold text-slate-900 mb-6">Récapitulatif</h3>
                        <div class="space-y-3 mb-6 pb-6 border-b border-slate-100 text-sm">
                            <div class="flex justify-between text-slate-500"><span>Sous-total</span><span class="font-medium text-slate-900" id="cart-subtotal">0,00 €</span></div>
                            <div class="flex justify-between text-slate-500"><span>Livraison</span><span class="text-green-600 font-medium">Offerte</span></div>
                            <div class="flex justify-between text-slate-500"><span>TVA (20%)</span><span class="font-medium text-slate-900" id="cart-tax">0,00 €</span></div>
                        </div>
                        <div class="flex justify-between items-center mb-6"><span class="font-semibold text-slate-900">Total</span><span class="font-display font-bold text-2xl text-slate-900" id="cart-total">0,00 €</span></div>
                        <button onclick="checkout()" class="w-full bg-brand-600 hover:bg-brand-500 text-white font-semibold py-4 rounded-lg transition-all shadow-lg shadow-brand-500/30 flex items-center justify-center gap-2">Payer ma commande</button>
                    </div>
                </div>
            </div>
        </div>
    </main>



    <!-- CHECKOUT MODAL -->
    <div id="checkout-modal" class="fixed inset-0 z-[70] hidden items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0" onclick="closeCheckoutModal()"></div>
        <div class="relative z-10 w-full max-w-2xl bg-white rounded-2xl shadow-2xl border border-slate-200 p-6 md:p-8 fade-in">
            <div class="flex items-start justify-between gap-4 mb-6">
                <div>
                    <h3 class="font-display text-2xl font-bold text-slate-900">Finaliser la commande</h3>
                    <p class="text-sm text-slate-500 mt-1">Confirmation client + notification boutique prêtes à l'envoi.</p>
                </div>
                <button onclick="closeCheckoutModal()" class="p-2 rounded-full bg-slate-100 hover:bg-slate-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>

            <form id="checkout-form" class="grid grid-cols-1 md:grid-cols-2 gap-4" onsubmit="confirmOrder(event)">
                <div>
                    <label class="text-xs font-semibold text-slate-700 uppercase tracking-wide">Nom complet</label>
                    <input id="order-name" required class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2.5 text-sm" placeholder="Jean Dupont">
                </div>
                <div>
                    <label class="text-xs font-semibold text-slate-700 uppercase tracking-wide">Email client</label>
                    <input id="order-email" type="email" required class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2.5 text-sm" placeholder="client@email.com">
                </div>
                <div>
                    <label class="text-xs font-semibold text-slate-700 uppercase tracking-wide">Téléphone</label>
                    <input id="order-phone" class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2.5 text-sm" placeholder="06 00 00 00 00">
                </div>
                <div>
                    <label class="text-xs font-semibold text-slate-700 uppercase tracking-wide">Adresse livraison</label>
                    <input id="order-address" required class="mt-1 w-full border border-slate-300 rounded-lg px-3 py-2.5 text-sm" placeholder="12 rue de Paris, 75000 Paris">
                </div>
                <div class="md:col-span-2 bg-slate-50 border border-slate-200 rounded-lg p-3 text-xs text-slate-600">
                    <p><span class="font-semibold text-slate-900">Email boutique:</span> <span id="checkout-shop-email">contact@partifymoto.fr</span></p>
                    <p class="mt-1">Pour l'envoi automatique réel, configurez EmailJS dans <code>emailConfig</code> (service/template/public key).</p>
                </div>
                <div class="md:col-span-2 flex items-center gap-3 pt-2">
                    <button type="submit" class="bg-brand-600 hover:bg-brand-500 text-white px-6 py-3 rounded-lg font-semibold">Valider et envoyer les emails</button>
                    <button type="button" onclick="closeCheckoutModal()" class="border border-slate-300 px-5 py-3 rounded-lg text-slate-700">Annuler</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 pt-16 pb-8 mt-auto">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                <div class="col-span-1 md:col-span-1">
                    <div class="flex items-center gap-2 mb-4">
                        <div class="w-6 h-6 bg-slate-900 rounded flex items-center justify-center text-white"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="iconify text-xs"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg></div>
                        <span class="font-display font-bold text-slate-900 tracking-tight uppercase">Partify</span>
                    </div>
                    <p class="text-sm text-slate-500 leading-relaxed">Spécialiste pièces motocross, enduro et route. Configurez votre moto pour ne plus jamais vous tromper.</p>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-4 text-xs uppercase tracking-wider">Catalogue</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="javascript:void(0)" onclick="navigateTo('catalog')" class="hover:text-brand-600">Yamaha</a></li>
                        <li><a href="javascript:void(0)" onclick="navigateTo('catalog')" class="hover:text-brand-600">KTM</a></li>
                        <li><a href="javascript:void(0)" onclick="navigateTo('catalog')" class="hover:text-brand-600">Honda</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-4 text-xs uppercase tracking-wider">Aide</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="#" class="hover:text-brand-600">Guide tailles</a></li>
                        <li><a href="#" class="hover:text-brand-600">Retours</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-4 text-xs uppercase tracking-wider">Contact</h4>
                    <p class="text-sm text-slate-500 mb-2">support@partify.com</p>
                </div>
            </div>
            <div class="border-t border-slate-100 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-slate-400">
                <p>© 2024 Partify Moto.</p>
            </div>
        </div>
    </footer>

    <!-- Logic Script -->
    <script>
        // --- DATA DATABASE ---
        const db = {
            bikes: {
                "Yamaha": ["YZ 125", "YZ 250", "YZF 250", "YZF 450", "Ténéré 700", "MT-07", "MT-09", "R1", "R6", "WRF 250"],
                "KTM": ["EXC 125", "EXC 250", "EXC 300", "SX 125", "SXF 250", "SXF 350", "SXF 450", "Duke 125", "Duke 390", "Adventure 890"],
                "Honda": ["CRF 250 R", "CRF 450 R", "CRF 1100 Africa Twin", "CB 500", "CB 650 R", "Hornet 750", "CBR 1000 RR"],
                "Kawasaki": ["KX 85", "KX 125", "KXF 250", "KXF 450", "Z650", "Z900", "Versys 650", "Ninja 400"],
                "Suzuki": ["RM 125", "RMZ 250", "RMZ 450", "V-Strom 650", "GSX-S 750", "Hayabusa"],
                "Husqvarna": ["TC 125", "TE 300", "FC 250", "FC 450", "FE 350", "Norden 901"],
                "GasGas": ["MC 125", "MC 250 F", "EC 300"],
                "Beta": ["RR 50", "RR 125", "RR 300", "RR 350 4T"]
            },
            products: [
                { id: 101, title: "Kit Plastiques Complet Acerbis", price: 169.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha"], models: ["YZF 250", "YZF 450", "WRF 250"], img: "https://images.unsplash.com/photo-1558980394-0c39336d7d57?auto=format&fit=crop&w=1200&q=80", desc: "Kit plastique complet Acerbis, finition OEM, excellente tenue UV et montage plug-and-play.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Livraison 48h entrepôt FR + 2 à 3 jours client", supplierSku: "ACB-KIT-YZF", cost: 132.0 },
                { id: 102, title: "Kit Plastiques Polisport KTM/HVA", price: 124.90, category: "Carénage", type: "Adaptable", brands: ["KTM", "Husqvarna"], models: ["EXC 300", "SXF 450", "TE 300"], img: "https://images.unsplash.com/photo-1558981806-ec527fa84c39?auto=format&fit=crop&w=1200&q=80", desc: "Plastiques Polisport flexibles et résistants, excellent rapport qualité/prix pour l'enduro engagé.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", supplierProductUrl: "https://www.krm-distribution.com/", delivery: "Expédié 24-48h + 2 à 4 jours transport", supplierSku: "POL-KIT-EXC", cost: 97.0 },
                { id: 103, title: "Kit Déco Factory Replica 300 microns", price: 129.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha", "Honda", "Kawasaki"], models: ["YZF 250", "CRF 450 R", "KXF 250"], img: "https://images.unsplash.com/photo-1626847037657-fd3622613ce3?auto=format&fit=crop&w=1200&q=80", desc: "Kit déco anti-rayure avec laminage épais 300 microns, colle haute adhérence spécial cross/enduro.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", supplierProductUrl: "https://www.tripleclampmoto.fr/", delivery: "Production 2 jours + livraison 48h", supplierSku: "TCM-DECO-FACT", cost: 88.0 },
                { id: 104, title: "Piston Vertex Haute Compression", price: 159.90, category: "Moteur", type: "Adaptable", brands: ["KTM", "Yamaha"], models: ["SXF 250", "YZF 250"], img: "https://images.unsplash.com/photo-1558981033-f5e2ddd9c57e?auto=format&fit=crop&w=1200&q=80", desc: "Piston forgé Vertex HC pour relance moteur plus franche et meilleure endurance thermique.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Disponibilité UE J+1, livraison client en 3 à 5 jours", supplierSku: "VTX-HC-250F", cost: 121.0 },
                { id: 105, title: "Filtre à Huile Hiflofiltro HF204", price: 9.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM"], models: ["Ténéré 700", "MT-07", "CRF 1100 Africa Twin"], img: "https://images.unsplash.com/photo-1486262715619-67b85e0b08d3?auto=format&fit=crop&w=1200&q=80", desc: "Filtre Hiflofiltro certifié TÜV, filtration fine, parfait pour entretien courant et révisions atelier.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "Stock FR expédié sous 24h, livraison 2 à 3 jours", supplierSku: "HF204", cost: 5.4 },
                { id: 106, title: "Ligne Akrapovič Titane Adventure", price: 1190.00, category: "Moteur", type: "OEM", brands: ["Yamaha", "KTM"], models: ["Ténéré 700", "Adventure 890"], img: "https://images.unsplash.com/photo-1449426468159-d96dbf08f19f?auto=format&fit=crop&w=1200&q=80", desc: "Ligne titane Akrapovič homologuée route, gain de poids et sonorité premium sans compromis fiabilité.", supplier: "Bihr Premium", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Précommande fournisseur : 5 à 8 jours ouvrés", supplierSku: "AKR-TI-ADV", cost: 958.0 },
                { id: 107, title: "Guidon Renthal Twinwall 997", price: 179.90, category: "Protection", type: "Adaptable", brands: ["KTM", "Honda", "Yamaha", "Kawasaki"], models: ["SXF 450", "CRF 450 R", "YZF 450"], img: "https://images.unsplash.com/photo-1558618047-fcd25c85cd64?auto=format&fit=crop&w=1200&q=80", desc: "Guidon Twinwall double tube, référence en résistance sur moto cross et supermotard.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Stock central UE, livraison estimée 3 à 4 jours", supplierSku: "RTH-TW-997", cost: 136.0 },
                { id: 108, title: "Sabot Moteur AXP HDPE 8mm", price: 149.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "KTM", "Husqvarna"], models: ["Ténéré 700", "Adventure 890", "Norden 901"], img: "https://images.unsplash.com/photo-1515777315835-281b94c9589f?auto=format&fit=crop&w=1200&q=80", desc: "Sabot AXP en polyéthylène 8 mm couvrant carters et biellettes pour pratique trail et hard enduro.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", supplierProductUrl: "https://www.krm-distribution.com/", delivery: "Traitement 48h + transport 2 à 4 jours", supplierSku: "AXP-SABOT-ADV", cost: 112.0 },
                { id: 109, title: "Kit Chaîne DID X-Ring Or", price: 119.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM", "Beta"], models: ["YZ 125", "MT-07", "Z900"], img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=1200&q=80", desc: "Kit chaîne DID X-Ring, usure réduite, tension stable et longévité adaptée aux gros rouleurs.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "Expédition sous 24h, livraison 2 à 3 jours", supplierSku: "DID-XR-525", cost: 87.0 },
                { id: 110, title: "Pneu Michelin Starcross 6 Medium", price: 89.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Yamaha", "Honda"], models: ["SXF 450", "YZF 450", "CRF 450 R"], img: "https://images.unsplash.com/photo-1558981285-6f0c94958bb6?auto=format&fit=crop&w=1200&q=80", desc: "Pneu cross Michelin Starcross 6 Medium, excellent grip sur terrain intermédiaire et bonne durée de vie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Stock UE variable, livraison constatée 3 à 6 jours", supplierSku: "MIC-STX6-M", cost: 66.0 },
                { id: 111, title: "Levier de Frein Repliable CNC", price: 49.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Husqvarna", "GasGas"], models: ["EXC 300", "TE 300", "EC 300"], img: "https://images.unsplash.com/photo-1474631245212-32dc3c8310c6?auto=format&fit=crop&w=1200&q=80", desc: "Levier CNC repliable anti-casse avec réglage d'écartement rapide pour un meilleur feeling au freinage.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", supplierProductUrl: "https://www.tripleclampmoto.fr/", delivery: "Préparation 24h, livraison 48 à 72h", supplierSku: "TCM-LEV-RPL", cost: 31.0 },
                { id: 112, title: "Bougie NGK Iridium CR9EIX", price: 18.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Kawasaki", "Suzuki"], models: ["MT-09", "Z900", "GSX-S 750"], img: "https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&w=1200&q=80", desc: "Bougie NGK Iridium pour démarrage rapide, combustion plus propre et longévité supérieure à l'origine.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "En stock FR, expédié le jour même avant 14h", supplierSku: "NGK-CR9EIX", cost: 11.7 },
                { id: 113, title: "Plaquettes Brembo Sinter Avant", price: 39.90, category: "Cycle", type: "OEM", brands: ["KTM", "Husqvarna", "Ducati"], models: ["EXC 300", "Duke 890"], img: "https://images.unsplash.com/photo-1609630875171-b1321377ee65?auto=format&fit=crop&w=1200&q=80", desc: "Plaquettes Brembo métal fritté pour freinage constant à chaud, pluie ou usage off-road.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Disponibilité immédiate : 2 à 4 jours ouvrés", supplierSku: "BRM-SINT-AV", cost: 26.0 },
                { id: 114, title: "Crash Bars SW-Motech Adventure", price: 239.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki"], models: ["Ténéré 700", "Africa Twin", "V-Strom 650"], img: "https://images.unsplash.com/photo-1625047509168-a7026f36de04?auto=format&fit=crop&w=1200&q=80", desc: "Crash bars acier SW-Motech avec points d'ancrage renforcés, protection moteur et carénages.", supplier: "SW-Motech B2B", supplierUrl: "https://sw-motech.com/", supplierProductUrl: "https://sw-motech.com/", delivery: "Produit import DE : livraison 4 à 7 jours", supplierSku: "SWM-CRB-ADV", cost: 182.0 },
                { id: 115, title: "Rétroviseurs Embout de Guidon CE", price: 59.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Kawasaki"], models: ["MT-07", "MT-09", "Z650", "Z900"], img: "https://images.unsplash.com/photo-1529429617124-aee711ecfc37?auto=format&fit=crop&w=1200&q=80", desc: "Paire de rétroviseurs embout de guidon homologués CE, aluminium anodisé, vision élargie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Disponibilité standard : 3 à 5 jours", supplierSku: "PE-MIR-BAR", cost: 42.0 }
            ],
            news: [
                { title: "Marché pièce moto 2026 : quelles tendances pour le dropshipping ?", img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=900&q=80", date: "11 Fév 2026", tag: "Marché", excerpt: "Hausse des demandes sur consommables (filtration, transmission, freinage). Les délais restent meilleurs chez les fournisseurs UE avec stocks localisés.", source: "Partify Veille", sourceUrl: "https://www.partseurope.eu/" },
                { title: "Guide achat: kit carénage OEM vs adaptable", img: "https://images.unsplash.com/photo-1558980394-0c39336d7d57?auto=format&fit=crop&w=1200&q=80", date: "10 Fév 2026", tag: "Guide", excerpt: "Comparatif matière, tenue UV et précision de montage pour aider à choisir entre qualité d'origine et alternatives premium.", source: "Partify Tech", sourceUrl: "https://www.bihr.eu/fr" },
                { title: "Entretien 4T: quand remplacer piston et bougie ?", img: "https://images.unsplash.com/photo-1558981033-f5e2ddd9c57e?auto=format&fit=crop&w=1200&q=80", date: "09 Fév 2026", tag: "Atelier", excerpt: "Intervals recommandés selon usage loisir/compétition et checklist avant commande pour éviter les incompatibilités.", source: "Partify Atelier", sourceUrl: "https://www.wemoto.fr/" },
                { title: "Freinage enduro: plaquettes sinter ou organiques", img: "https://images.unsplash.com/photo-1609630875171-b1321377ee65?auto=format&fit=crop&w=1200&q=80", date: "08 Fév 2026", tag: "Sécurité", excerpt: "Le sinter garde un mordant constant à chaud, l'organique favorise la progressivité sur terrain glissant.", source: "Partify Safety", sourceUrl: "https://www.brembo.com/" },
                { title: "Transmission: bien dimensionner son kit chaîne", img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=900&q=80", date: "07 Fév 2026", tag: "Tuto", excerpt: "Pas, nombre de dents et entretien: les 3 points qui font la différence sur la longévité et le comportement moto.", source: "Partify Garage", sourceUrl: "https://www.didchain.com/" },
                { title: "Protection trail: crash bars et sabot, montage conseillé", img: "https://images.unsplash.com/photo-1625047509168-a7026f36de04?auto=format&fit=crop&w=1200&q=80", date: "06 Fév 2026", tag: "Adventure", excerpt: "Retours terrain sur les couples de serrage et l'ordre de montage pour limiter vibrations et contraintes châssis.", source: "Partify Adventure", sourceUrl: "https://sw-motech.com/" }
                { id: 101, title: "Kit Plastiques Complet Acerbis", price: 169.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha"], models: ["YZF 250", "YZF 450", "WRF 250"], img: "https://www.3as-racing.com/pub/media/catalog/product/k/i/kit-plastique-acerbis-noir-yamaha-yz-125-250-2022-2024-yzf-250-450-2023-2024.jpg", desc: "Kit plastique complet Acerbis, finition OEM, excellente tenue UV et montage plug-and-play.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Livraison 48h entrepôt FR + 2 à 3 jours client", supplierSku: "ACB-KIT-YZF", cost: 132.0 },
                { id: 102, title: "Kit Plastiques Polisport KTM/HVA", price: 124.90, category: "Carénage", type: "Adaptable", brands: ["KTM", "Husqvarna"], models: ["EXC 300", "SXF 450", "TE 300"], img: "https://www.3as-racing.com/pub/media/catalog/product/k/i/kit-plastique-polisport-gris-nardo-gris-ktm-125-a-500-exc-exc-f-2020-2022-d023a.jpg", desc: "Plastiques Polisport flexibles et résistants, excellent rapport qualité/prix pour l'enduro engagé.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", supplierProductUrl: "https://www.krm-distribution.com/", delivery: "Expédié 24-48h + 2 à 4 jours transport", supplierSku: "POL-KIT-EXC", cost: 97.0 },
                { id: 103, title: "Kit Déco Factory Replica 300 microns", price: 129.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha", "Honda", "Kawasaki"], models: ["YZF 250", "CRF 450 R", "KXF 250"], img: "https://www.blackbirdracing.com/wp-content/uploads/2021/05/dream4-kit-grafica-moto-cross-enduro.jpg", desc: "Kit déco anti-rayure avec laminage épais 300 microns, colle haute adhérence spécial cross/enduro.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", supplierProductUrl: "https://www.tripleclampmoto.fr/", delivery: "Production 2 jours + livraison 48h", supplierSku: "TCM-DECO-FACT", cost: 88.0 },
                { id: 104, title: "Piston Vertex Haute Compression", price: 159.90, category: "Moteur", type: "Adaptable", brands: ["KTM", "Yamaha"], models: ["SXF 250", "YZF 250"], img: "https://m.media-amazon.com/images/I/71R3yL7B+NL._AC_SL1500_.jpg", desc: "Piston forgé Vertex HC pour relance moteur plus franche et meilleure endurance thermique.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Disponibilité UE J+1, livraison client en 3 à 5 jours", supplierSku: "VTX-HC-250F", cost: 121.0 },
                { id: 105, title: "Filtre à Huile Hiflofiltro HF204", price: 9.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM"], models: ["Ténéré 700", "MT-07", "CRF 1100 Africa Twin"], img: "https://m.media-amazon.com/images/I/61NlqJm8VPL._AC_SL1181_.jpg", desc: "Filtre Hiflofiltro certifié TÜV, filtration fine, parfait pour entretien courant et révisions atelier.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "Stock FR expédié sous 24h, livraison 2 à 3 jours", supplierSku: "HF204", cost: 5.4 },
                { id: 106, title: "Ligne Akrapovič Titane Adventure", price: 1190.00, category: "Moteur", type: "OEM", brands: ["Yamaha", "KTM"], models: ["Ténéré 700", "Adventure 890"], img: "https://m.media-amazon.com/images/I/61X-w+r5+ZL._AC_SL1000_.jpg", desc: "Ligne titane Akrapovič homologuée route, gain de poids et sonorité premium sans compromis fiabilité.", supplier: "Bihr Premium", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Précommande fournisseur : 5 à 8 jours ouvrés", supplierSku: "AKR-TI-ADV", cost: 958.0 },
                { id: 107, title: "Guidon Renthal Twinwall 997", price: 179.90, category: "Protection", type: "Adaptable", brands: ["KTM", "Honda", "Yamaha", "Kawasaki"], models: ["SXF 450", "CRF 450 R", "YZF 450"], img: "https://m.media-amazon.com/images/I/61t-Xb+vj+L._AC_SL1500_.jpg", desc: "Guidon Twinwall double tube, référence en résistance sur moto cross et supermotard.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Stock central UE, livraison estimée 3 à 4 jours", supplierSku: "RTH-TW-997", cost: 136.0 },
                { id: 108, title: "Sabot Moteur AXP HDPE 8mm", price: 149.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "KTM", "Husqvarna"], models: ["Ténéré 700", "Adventure 890", "Norden 901"], img: "https://www.axp-racing.com/wp-content/uploads/2022/06/PHD-skid-plate.jpg", desc: "Sabot AXP en polyéthylène 8 mm couvrant carters et biellettes pour pratique trail et hard enduro.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", supplierProductUrl: "https://www.krm-distribution.com/", delivery: "Traitement 48h + transport 2 à 4 jours", supplierSku: "AXP-SABOT-ADV", cost: 112.0 },
                { id: 109, title: "Kit Chaîne DID X-Ring Or", price: 119.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM", "Beta"], models: ["YZ 125", "MT-07", "Z900"], img: "https://m.media-amazon.com/images/I/71w+b+vj+L._AC_SL1500_.jpg", desc: "Kit chaîne DID X-Ring, usure réduite, tension stable et longévité adaptée aux gros rouleurs.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "Expédition sous 24h, livraison 2 à 3 jours", supplierSku: "DID-XR-525", cost: 87.0 },
                { id: 110, title: "Pneu Michelin Starcross 6 Medium", price: 89.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Yamaha", "Honda"], models: ["SXF 450", "YZF 450", "CRF 450 R"], img: "https://www.dafy-moto.com/images/product/medium/pneu-michelin-starcross-6-medium-soft-arriere-632008f170423.jpg", desc: "Pneu cross Michelin Starcross 6 Medium, excellent grip sur terrain intermédiaire et bonne durée de vie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Stock UE variable, livraison constatée 3 à 6 jours", supplierSku: "MIC-STX6-M", cost: 66.0 },
                { id: 111, title: "Levier de Frein Repliable CNC", price: 49.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Husqvarna", "GasGas"], models: ["EXC 300", "TE 300", "EC 300"], img: "https://m.media-amazon.com/images/I/61r-Xb+vj+L._AC_SL1500_.jpg", desc: "Levier CNC repliable anti-casse avec réglage d'écartement rapide pour un meilleur feeling au freinage.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", supplierProductUrl: "https://www.tripleclampmoto.fr/", delivery: "Préparation 24h, livraison 48 à 72h", supplierSku: "TCM-LEV-RPL", cost: 31.0 },
                { id: 112, title: "Bougie NGK Iridium CR9EIX", price: 18.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Kawasaki", "Suzuki"], models: ["MT-09", "Z900", "GSX-S 750"], img: "https://m.media-amazon.com/images/I/71+b+vj+L._AC_SL1500_.jpg", desc: "Bougie NGK Iridium pour démarrage rapide, combustion plus propre et longévité supérieure à l'origine.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", supplierProductUrl: "https://www.wemoto.fr/", delivery: "En stock FR, expédié le jour même avant 14h", supplierSku: "NGK-CR9EIX", cost: 11.7 },
                { id: 113, title: "Plaquettes Brembo Sinter Avant", price: 39.90, category: "Cycle", type: "OEM", brands: ["KTM", "Husqvarna", "Ducati"], models: ["EXC 300", "Duke 890"], img: "https://m.media-amazon.com/images/I/81+b+vj+L._AC_SL1500_.jpg", desc: "Plaquettes Brembo métal fritté pour freinage constant à chaud, pluie ou usage off-road.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", supplierProductUrl: "https://www.bihr.eu/fr", delivery: "Disponibilité immédiate : 2 à 4 jours ouvrés", supplierSku: "BRM-SINT-AV", cost: 26.0 },
                { id: 114, title: "Crash Bars SW-Motech Adventure", price: 239.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki"], models: ["Ténéré 700", "Africa Twin", "V-Strom 650"], img: "https://sw-motech.com/cosmoshop/default/pix/a/g/sbl_06_799_10001_b_2_xl.jpg", desc: "Crash bars acier SW-Motech avec points d'ancrage renforcés, protection moteur et carénages.", supplier: "SW-Motech B2B", supplierUrl: "https://sw-motech.com/", supplierProductUrl: "https://sw-motech.com/", delivery: "Produit import DE : livraison 4 à 7 jours", supplierSku: "SWM-CRB-ADV", cost: 182.0 },
                { id: 115, title: "Rétroviseurs Embout de Guidon CE", price: 59.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Kawasaki"], models: ["MT-07", "MT-09", "Z650", "Z900"], img: "https://m.media-amazon.com/images/I/61s+b+vj+L._AC_SL1500_.jpg", desc: "Paire de rétroviseurs embout de guidon homologués CE, aluminium anodisé, vision élargie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", supplierProductUrl: "https://www.partseurope.eu/", delivery: "Disponibilité standard : 3 à 5 jours", supplierSku: "PE-MIR-BAR", cost: 42.0 }
                { id: 101, title: "Kit Plastiques Complet Acerbis", price: 169.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha"], models: ["YZF 250", "YZF 450", "WRF 250"], img: "https://images.unsplash.com/photo-1558980394-0c39336d7d57?auto=format&fit=crop&w=900&q=80", desc: "Kit plastique complet Acerbis, finition OEM, excellente tenue UV et montage plug-and-play.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", delivery: "Livraison 48h entrepôt FR + 2 à 3 jours client", supplierSku: "ACB-KIT-YZF", cost: 132.0 },
                { id: 102, title: "Kit Plastiques Polisport KTM/HVA", price: 124.90, category: "Carénage", type: "Adaptable", brands: ["KTM", "Husqvarna"], models: ["EXC 300", "SXF 450", "TE 300"], img: "https://images.unsplash.com/photo-1558981806-ec527fa84c39?auto=format&fit=crop&w=900&q=80", desc: "Plastiques Polisport flexibles et résistants, excellent rapport qualité/prix pour l'enduro engagé.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", delivery: "Expédié 24-48h + 2 à 4 jours transport", supplierSku: "POL-KIT-EXC", cost: 97.0 },
                { id: 103, title: "Kit Déco Factory Replica 300 microns", price: 129.90, category: "Carénage", type: "Adaptable", brands: ["Yamaha", "Honda", "Kawasaki"], models: ["YZF 250", "CRF 450 R", "KXF 250"], img: "https://images.unsplash.com/photo-1626847037657-fd3622613ce3?auto=format&fit=crop&w=900&q=80", desc: "Kit déco anti-rayure avec laminage épais 300 microns, colle haute adhérence spécial cross/enduro.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", delivery: "Production 2 jours + livraison 48h", supplierSku: "TCM-DECO-FACT", cost: 88.0 },
                { id: 104, title: "Piston Vertex Haute Compression", price: 159.90, category: "Moteur", type: "Adaptable", brands: ["KTM", "Yamaha"], models: ["SXF 250", "YZF 250"], img: "https://images.unsplash.com/photo-1558981033-f5e2ddd9c57e?auto=format&fit=crop&w=900&q=80", desc: "Piston forgé Vertex HC pour relance moteur plus franche et meilleure endurance thermique.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", delivery: "Disponibilité UE J+1, livraison client en 3 à 5 jours", supplierSku: "VTX-HC-250F", cost: 121.0 },
                { id: 105, title: "Filtre à Huile Hiflofiltro HF204", price: 9.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM"], models: ["Ténéré 700", "MT-07", "CRF 1100 Africa Twin"], img: "https://images.unsplash.com/photo-1486262715619-67b85e0b08d3?auto=format&fit=crop&w=900&q=80", desc: "Filtre Hiflofiltro certifié TÜV, filtration fine, parfait pour entretien courant et révisions atelier.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", delivery: "Stock FR expédié sous 24h, livraison 2 à 3 jours", supplierSku: "HF204", cost: 5.4 },
                { id: 106, title: "Ligne Akrapovič Titane Adventure", price: 1190.00, category: "Moteur", type: "OEM", brands: ["Yamaha", "KTM"], models: ["Ténéré 700", "Adventure 890"], img: "https://images.unsplash.com/photo-1449426468159-d96dbf08f19f?auto=format&fit=crop&w=900&q=80", desc: "Ligne titane Akrapovič homologuée route, gain de poids et sonorité premium sans compromis fiabilité.", supplier: "Bihr Premium", supplierUrl: "https://www.bihr.eu/fr", delivery: "Précommande fournisseur : 5 à 8 jours ouvrés", supplierSku: "AKR-TI-ADV", cost: 958.0 },
                { id: 107, title: "Guidon Renthal Twinwall 997", price: 179.90, category: "Protection", type: "Adaptable", brands: ["KTM", "Honda", "Yamaha", "Kawasaki"], models: ["SXF 450", "CRF 450 R", "YZF 450"], img: "https://images.unsplash.com/photo-1558618047-fcd25c85cd64?auto=format&fit=crop&w=900&q=80", desc: "Guidon Twinwall double tube, référence en résistance sur moto cross et supermotard.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", delivery: "Stock central UE, livraison estimée 3 à 4 jours", supplierSku: "RTH-TW-997", cost: 136.0 },
                { id: 108, title: "Sabot Moteur AXP HDPE 8mm", price: 149.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "KTM", "Husqvarna"], models: ["Ténéré 700", "Adventure 890", "Norden 901"], img: "https://images.unsplash.com/photo-1515777315835-281b94c9589f?auto=format&fit=crop&w=900&q=80", desc: "Sabot AXP en polyéthylène 8 mm couvrant carters et biellettes pour pratique trail et hard enduro.", supplier: "KRM Distribution", supplierUrl: "https://www.krm-distribution.com/", delivery: "Traitement 48h + transport 2 à 4 jours", supplierSku: "AXP-SABOT-ADV", cost: 112.0 },
                { id: 109, title: "Kit Chaîne DID X-Ring Or", price: 119.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki", "Kawasaki", "KTM", "Beta"], models: ["YZ 125", "MT-07", "Z900"], img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=900&q=80", desc: "Kit chaîne DID X-Ring, usure réduite, tension stable et longévité adaptée aux gros rouleurs.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", delivery: "Expédition sous 24h, livraison 2 à 3 jours", supplierSku: "DID-XR-525", cost: 87.0 },
                { id: 110, title: "Pneu Michelin Starcross 6 Medium", price: 89.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Yamaha", "Honda"], models: ["SXF 450", "YZF 450", "CRF 450 R"], img: "https://images.unsplash.com/photo-1558981285-6f0c94958bb6?auto=format&fit=crop&w=900&q=80", desc: "Pneu cross Michelin Starcross 6 Medium, excellent grip sur terrain intermédiaire et bonne durée de vie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", delivery: "Stock UE variable, livraison constatée 3 à 6 jours", supplierSku: "MIC-STX6-M", cost: 66.0 },
                { id: 111, title: "Levier de Frein Repliable CNC", price: 49.90, category: "Cycle", type: "Adaptable", brands: ["KTM", "Husqvarna", "GasGas"], models: ["EXC 300", "TE 300", "EC 300"], img: "https://images.unsplash.com/photo-1474631245212-32dc3c8310c6?auto=format&fit=crop&w=900&q=80", desc: "Levier CNC repliable anti-casse avec réglage d'écartement rapide pour un meilleur feeling au freinage.", supplier: "Tripleclamp Moto", supplierUrl: "https://www.tripleclampmoto.fr/", delivery: "Préparation 24h, livraison 48 à 72h", supplierSku: "TCM-LEV-RPL", cost: 31.0 },
                { id: 112, title: "Bougie NGK Iridium CR9EIX", price: 18.90, category: "Moteur", type: "Adaptable", brands: ["Yamaha", "Kawasaki", "Suzuki"], models: ["MT-09", "Z900", "GSX-S 750"], img: "https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&w=900&q=80", desc: "Bougie NGK Iridium pour démarrage rapide, combustion plus propre et longévité supérieure à l'origine.", supplier: "Wemoto", supplierUrl: "https://www.wemoto.fr/", delivery: "En stock FR, expédié le jour même avant 14h", supplierSku: "NGK-CR9EIX", cost: 11.7 },
                { id: 113, title: "Plaquettes Brembo Sinter Avant", price: 39.90, category: "Cycle", type: "OEM", brands: ["KTM", "Husqvarna", "Ducati"], models: ["EXC 300", "Duke 890"], img: "https://images.unsplash.com/photo-1609630875171-b1321377ee65?auto=format&fit=crop&w=900&q=80", desc: "Plaquettes Brembo métal fritté pour freinage constant à chaud, pluie ou usage off-road.", supplier: "Bihr (dropshipping B2B)", supplierUrl: "https://www.bihr.eu/fr", delivery: "Disponibilité immédiate : 2 à 4 jours ouvrés", supplierSku: "BRM-SINT-AV", cost: 26.0 },
                { id: 114, title: "Crash Bars SW-Motech Adventure", price: 239.90, category: "Protection", type: "Adaptable", brands: ["Yamaha", "Honda", "Suzuki"], models: ["Ténéré 700", "Africa Twin", "V-Strom 650"], img: "https://images.unsplash.com/photo-1625047509168-a7026f36de04?auto=format&fit=crop&w=900&q=80", desc: "Crash bars acier SW-Motech avec points d'ancrage renforcés, protection moteur et carénages.", supplier: "SW-Motech B2B", supplierUrl: "https://sw-motech.com/", delivery: "Produit import DE : livraison 4 à 7 jours", supplierSku: "SWM-CRB-ADV", cost: 182.0 },
                { id: 115, title: "Rétroviseurs Embout de Guidon CE", price: 59.90, category: "Cycle", type: "Adaptable", brands: ["Yamaha", "Kawasaki"], models: ["MT-07", "MT-09", "Z650", "Z900"], img: "https://images.unsplash.com/photo-1529429617124-aee711ecfc37?auto=format&fit=crop&w=900&q=80", desc: "Paire de rétroviseurs embout de guidon homologués CE, aluminium anodisé, vision élargie.", supplier: "Parts Europe", supplierUrl: "https://www.partseurope.eu/", delivery: "Disponibilité standard : 3 à 5 jours", supplierSku: "PE-MIR-BAR", cost: 42.0 }
            ],
            news: [
                { title: "Marché pièce moto 2026 : quelles tendances pour le dropshipping ?", img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=900&q=80", date: "11 Fév 2026", tag: "Marché", excerpt: "Hausse des demandes sur consommables (filtration, transmission, freinage). Les délais restent meilleurs chez les fournisseurs UE avec stocks localisés.", source: "Partify Veille", sourceUrl: "https://www.partseurope.eu/" },
                { title: "Guide achat: kit carénage OEM vs adaptable", img: "https://www.3as-racing.com/pub/media/catalog/product/k/i/kit-plastique-acerbis-noir-yamaha-yz-125-250-2022-2024-yzf-250-450-2023-2024.jpg", date: "10 Fév 2026", tag: "Guide", excerpt: "Comparatif matière, tenue UV et précision de montage pour aider à choisir entre qualité d'origine et alternatives premium.", source: "Partify Tech", sourceUrl: "https://www.bihr.eu/fr" },
                { title: "Entretien 4T: quand remplacer piston et bougie ?", img: "https://m.media-amazon.com/images/I/71R3yL7B+NL._AC_SL1500_.jpg", date: "09 Fév 2026", tag: "Atelier", excerpt: "Intervals recommandés selon usage loisir/compétition et checklist avant commande pour éviter les incompatibilités.", source: "Partify Atelier", sourceUrl: "https://www.wemoto.fr/" },
                { title: "Freinage enduro: plaquettes sinter ou organiques", img: "https://m.media-amazon.com/images/I/81+b+vj+L._AC_SL1500_.jpg", date: "08 Fév 2026", tag: "Sécurité", excerpt: "Le sinter garde un mordant constant à chaud, l'organique favorise la progressivité sur terrain glissant.", source: "Partify Safety", sourceUrl: "https://www.brembo.com/" },
                { title: "Transmission: bien dimensionner son kit chaîne", img: "https://images.unsplash.com/photo-1580310614729-ccd69652491d?auto=format&fit=crop&w=900&q=80", date: "07 Fév 2026", tag: "Tuto", excerpt: "Pas, nombre de dents et entretien: les 3 points qui font la différence sur la longévité et le comportement moto.", source: "Partify Garage", sourceUrl: "https://www.didchain.com/" },
                { title: "Protection trail: crash bars et sabot, montage conseillé", img: "https://sw-motech.com/cosmoshop/default/pix/a/g/sbl_06_799_10001_b_2_xl.jpg", date: "06 Fév 2026", tag: "Adventure", excerpt: "Retours terrain sur les couples de serrage et l'ordre de montage pour limiter vibrations et contraintes châssis.", source: "Partify Adventure", sourceUrl: "https://sw-motech.com/" }
            ]
        };

        // --- STATE ---
        let cart = [];
        let garage = { brand: null, model: null, year: null };
        let activeCategory = 'all';

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            populateBrandSelects();
            renderNews();
        });

        function populateBrandSelects() {
            const brands = Object.keys(db.bikes);
            const options = brands.map(b => `<option value="${b}">${b}</option>`).join('');
            
            const heroSelect = document.getElementById('hero-brand');
            const sidebarSelect = document.getElementById('sidebar-brand');
            
            if(heroSelect) heroSelect.innerHTML += options;
            if(sidebarSelect) sidebarSelect.innerHTML += options;
        }

        // --- NAVIGATION & UI LOGIC ---
        function navigateTo(pageId) {
            ['home', 'catalog', 'cart', 'news'].forEach(p => {
                const el = document.getElementById('page-' + p);
                if (el) {
                    if (p === pageId) {
                        el.classList.remove('hidden');
                        el.classList.add('fade-in');
                        if (p === 'cart') renderCartPage();
                        if (p === 'catalog') renderCatalog();
                    } else {
                        el.classList.add('hidden');
                    }
                }
            });
            window.scrollTo(0, 0);
        }

        // --- GARAGE LOGIC ---
        function updateModels(context) {
            const brandSelect = document.getElementById(context === 'hero' ? 'hero-brand' : 'sidebar-brand');
            const modelSelect = document.getElementById(context === 'hero' ? 'hero-model' : 'sidebar-model');
            const brand = brandSelect.value;
            
            modelSelect.innerHTML = '<option value="">Modèle...</option>';
            modelSelect.disabled = true;

            if (brand && db.bikes[brand]) {
                const models = db.bikes[brand];
                modelSelect.innerHTML += models.map(m => `<option value="${m}">${m}</option>`).join('');
                modelSelect.disabled = false;
            }
        }

        function setGarageFromHero() {
            const brand = document.getElementById('hero-brand').value;
            const model = document.getElementById('hero-model').value;
            const year = document.getElementById('hero-year').value;

            if (brand && model) {
                setGarage(brand, model, year);
                navigateTo('catalog');
            } else {
                alert("Merci de sélectionner une marque et un modèle.");
            }
        }

        function setGarageFromSidebar() {
            const brand = document.getElementById('sidebar-brand').value;
            const model = document.getElementById('sidebar-model').value;
            const year = document.getElementById('sidebar-year').value;

            if (brand && model) {
                setGarage(brand, model, year);
            }
        }

        function setGarage(brand, model, year) {
            garage = { brand, model, year };
            
            // Update UI
            document.getElementById('garage-active').classList.remove('hidden');
            document.getElementById('garage-empty').classList.add('hidden');
            document.getElementById('garage-selector').classList.add('hidden');
            
            document.getElementById('garage-brand-display').innerText = brand;
            document.getElementById('garage-model-display').innerText = model;
            document.getElementById('garage-year-display').innerText = year || "Année inconnue";

            // Header Indicator
            const headerStatus = document.getElementById('user-garage-status');
            headerStatus.classList.remove('bg-slate-100', 'text-slate-600');
            headerStatus.classList.add('bg-brand-50', 'text-brand-600', 'border-brand-200');
            headerStatus.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> ${model}`;

            renderCatalog();
            showToast(`Garage mis à jour : ${brand} ${model}`);
        }

        function clearGarage() {
            garage = { brand: null, model: null, year: null };
            document.getElementById('garage-active').classList.add('hidden');
            document.getElementById('garage-empty').classList.remove('hidden');
            
            const headerStatus = document.getElementById('user-garage-status');
            headerStatus.classList.add('bg-slate-100', 'text-slate-600');
            headerStatus.classList.remove('bg-brand-50', 'text-brand-600', 'border-brand-200');
            headerStatus.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg> Garage`;

            renderCatalog();
        }

        // --- CATALOG LOGIC ---
        function renderNews() {
            const container = document.getElementById('news-grid');
            if(!container) return;
            container.innerHTML = db.news.map(n => `
                <div class="bg-white rounded-xl overflow-hidden border border-slate-200 hover:shadow-lg transition-all group cursor-pointer">
                    <div class="h-48 overflow-hidden relative">
                        <img src="${n.img}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                        <span class="absolute top-4 left-4 bg-white/90 backdrop-blur text-xs font-bold px-2 py-1 rounded text-slate-900">${n.tag}</span>
                    </div>
                    <div class="p-6">
                        <p class="text-xs text-slate-400 mb-2">${n.date}</p>
                        <h3 class="font-display font-bold text-lg text-slate-900 mb-2 leading-tight group-hover:text-brand-600 transition-colors">${n.title}</h3>
                        <p class="text-sm text-slate-600 leading-relaxed">${n.excerpt}</p>
                        <div class="mt-4 flex items-center justify-between gap-3">
                            <a href="${n.sourceUrl}" target="_blank" rel="noopener" class="text-xs text-slate-500 hover:text-brand-600">Source: ${n.source}</a>
                            <span class="flex items-center text-brand-600 text-sm font-medium">Lire l'article <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterCatalogCategory(cat) {
            activeCategory = cat;
            const checkboxes = document.querySelectorAll('#category-filters input');
            checkboxes.forEach(cb => {
                if(cb.value === cat) cb.checked = true;
                else cb.checked = false;
            });
            renderCatalog();
        }
        
        function handleGlobalSearch(e) {
            if (e.key === 'Enter' || e.type === 'keyup') {
                const term = e.target.value;
                if(term.length > 2) {
                    navigateTo('catalog');
                    renderCatalog(term);
                } else if (term.length === 0) {
                    renderCatalog();
                }
            }
        }

        function getFallbackImage(label = 'Produit') {
            const text = encodeURIComponent(label);
            return `https://placehold.co/800x600/f8fafc/334155?text=${text}`;
        }

        function renderCatalog(searchTerm = '') {
            const container = document.getElementById('product-grid');
            const noResults = document.getElementById('no-results');
            const filtersContainer = document.getElementById('category-filters');

            // Render Filters (Static for now but could be dynamic)
            const categories = ["Carénage", "Moteur", "Cycle", "Protection"];
            filtersContainer.innerHTML = categories.map(c => `
                <label class="flex items-center gap-3 cursor-pointer group">
                    <input type="checkbox" value="${c}" onchange="toggleCategory('${c}')" ${activeCategory === c ? 'checked' : ''} class="w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500">
                    <span class="text-sm text-slate-700 group-hover:text-brand-600">${c}</span>
                </label>
            `).join('');

            // Filter Products
            let filtered = db.products.filter(p => {
                // Category Filter
                const catMatch = activeCategory === 'all' || p.category === activeCategory;
                
                // Search Filter
                const searchMatch = searchTerm === '' || 
                                    p.title.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                    p.category.toLowerCase().includes(searchTerm.toLowerCase());

                // Garage Compatibility Filter (Ranking, not strict hiding)
                return catMatch && searchMatch;
            });

            // Sorting Logic
            const sortVal = document.getElementById('sort-select').value;
            if(sortVal === 'price-asc') filtered.sort((a,b) => a.price - b.price);
            if(sortVal === 'price-desc') filtered.sort((a,b) => b.price - a.price);

            if (filtered.length === 0) {
                container.classList.add('hidden');
                noResults.classList.remove('hidden');
            } else {
                container.classList.remove('hidden');
                noResults.classList.add('hidden');
                
                container.innerHTML = filtered.map(p => {
                    // Check compatibility
                    let isCompatible = false;
                    let compatBadge = '';
                    
                    if (garage.model) {
                        // Logic: check if product brand list includes garage brand, AND product model list includes garage model
                        // Or if product is generic (lists many)
                        if (p.brands.includes(garage.brand) && (p.models.includes(garage.model) || p.models.length > 5)) {
                            isCompatible = true;
                            compatBadge = `<div class="absolute bottom-3 left-3 bg-green-100 text-green-700 border border-green-200 px-2 py-1 rounded text-[10px] font-bold flex items-center gap-1 z-10"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> Compatible</div>`;
                        } else {
                             compatBadge = `<div class="absolute bottom-3 left-3 bg-slate-100 text-slate-500 border border-slate-200 px-2 py-1 rounded text-[10px] font-medium z-10">Vérifier compatibilité</div>`;
                        }
                    }

                    return `
                    <div class="group bg-white rounded-xl border ${isCompatible ? 'border-green-300 ring-1 ring-green-100' : 'border-slate-200'} overflow-hidden hover:shadow-xl hover:shadow-slate-200/50 transition-all duration-300 flex flex-col relative h-[420px]">
                        <span class="absolute top-3 right-3 bg-white text-slate-600 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider z-10 border border-slate-200 shadow-sm">${p.type}</span>
                        ${compatBadge}
                        <div class="relative h-48 overflow-hidden bg-slate-50 p-6 flex items-center justify-center cursor-pointer" onclick="openProductModal(${p.id})">
                            <img src="${p.img}" alt="${p.title}" onerror="this.onerror=null;this.src=getFallbackImage('Photo produit');" class="object-contain w-full h-full group-hover:scale-110 transition-transform duration-500">
                        </div>
                        <div class="p-5 flex-1 flex flex-col">
                            <div class="text-xs text-slate-400 font-medium mb-1">${p.category}</div>
                            <h3 class="font-medium text-slate-900 mb-1 line-clamp-2 cursor-pointer hover:text-brand-600" onclick="openProductModal(${p.id})">${p.title}</h3>
                            <p class="text-xs text-slate-500 mb-2 line-clamp-2">${p.desc}</p>
                            <p class="text-[11px] text-slate-400 mb-3">Fournisseur: ${p.supplier}</p>
                            <p class="text-[11px] text-slate-400 mb-4">${p.delivery}</p>
                            <div class="mt-auto flex items-center justify-between">
                                <span class="font-display font-bold text-lg text-slate-900">${p.price.toFixed(2)} €</span>
                                <div class="flex gap-2">
                                    <button onclick="openProductModal(${p.id})" class="w-9 h-9 rounded-lg border border-slate-200 text-slate-500 flex items-center justify-center hover:bg-slate-50 transition-colors" title="Voir détails">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                                    </button>
                                    <button onclick="addToCart(${p.id})" class="w-9 h-9 rounded-lg bg-slate-900 text-white flex items-center justify-center hover:bg-brand-600 transition-colors shadow-md">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14m-7-7v14"></path></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `}).join('');
            }
        }

        function toggleCategory(cat) {
            if (activeCategory === cat) activeCategory = 'all';
            else activeCategory = cat;
            renderCatalog();
        }

        // --- MODAL LOGIC ---
        function openProductModal(id) {
            const p = db.products.find(x => x.id === id);
            if (!p) return;

            const modalImg = document.getElementById('modal-img');
            modalImg.src = p.img;
            modalImg.alt = p.title;
            modalImg.onerror = () => { modalImg.onerror = null; modalImg.src = getFallbackImage(p.title); };
            document.getElementById('modal-title').innerText = p.title;
            document.getElementById('modal-brand').innerText = p.brands[0] || "Universel";
            document.getElementById('modal-ref').innerText = `REF: PTY-${p.id}`;
            document.getElementById('modal-price').innerText = p.price.toFixed(2) + " €";
            document.getElementById('modal-desc').innerText = p.desc;
            document.getElementById('modal-supplier').innerText = p.supplier;
            document.getElementById('modal-supplier').href = p.supplierUrl;
            document.getElementById('modal-supplier-product').href = p.supplierProductUrl || p.supplierUrl;
            document.getElementById('modal-order-supplier').href = p.supplierProductUrl || p.supplierUrl;
            document.getElementById('modal-delivery').innerText = p.delivery;
            
            // Compatibility Check inside Modal
            const compatBox = document.getElementById('modal-compatibility-box');
            if (garage.model && (p.brands.includes(garage.brand) && (p.models.includes(garage.model) || p.models.length > 5))) {
                compatBox.classList.remove('hidden');
                document.getElementById('modal-bike-name').innerText = `${garage.brand} ${garage.model}`;
            } else {
                compatBox.classList.add('hidden');
            }

            // Fake specs
            document.getElementById('modal-specs').innerHTML = `
                <li class="text-xs">Type: ${p.type}</li>
                <li class="text-xs">Catégorie: ${p.category}</li>
                <li class="text-xs">Réf fournisseur: ${p.supplierSku}</li>
                <li class="text-xs">Statut fournisseur: relié (manuel)</li>
                <li class="text-xs">Marge estimée: ${((p.price - p.cost) / p.price * 100).toFixed(0)}%</li>
                <li class="text-xs">Garantie: 2 ans constructeur</li>
            `;

            const addBtn = document.getElementById('modal-add-btn');
            addBtn.onclick = () => { addToCart(p.id); closeModal(); };

            document.getElementById('product-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('product-modal').classList.add('hidden');
        }

        // --- CART LOGIC ---
        function addToCart(id) {
            const p = db.products.find(x => x.id === id);
            if (!p) return;

            const existingItem = cart.find(item => item.id === id);
            if (existingItem) {
                existingItem.qty++;
            } else {
                cart.push({ ...p, qty: 1 });
            }
            
            updateCartCounter();
            showToast(`Ajouté au panier : ${p.title}`);
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            renderCartPage();
            updateCartCounter();
        }

        function updateQty(id, change) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.qty += change;
                if (item.qty <= 0) removeFromCart(id);
                else renderCartPage();
            }
        }

        function updateCartCounter() {
            const count = cart.reduce((acc, item) => acc + item.qty, 0);
            const badge = document.getElementById('cart-count');
            badge.innerText = count;
            badge.style.opacity = count > 0 ? '1' : '0';
        }

        function renderCartPage() {
            const container = document.getElementById('cart-items-container');
            const emptyState = document.getElementById('cart-empty-state');
            const content = document.getElementById('cart-content');
            
            const subtotal = cart.reduce((acc, item) => acc + (item.price * item.qty), 0);
            const total = subtotal; 

            document.getElementById('cart-subtotal').innerText = subtotal.toFixed(2) + " €"; 
            document.getElementById('cart-tax').innerText = (subtotal * 0.20).toFixed(2) + " €";
            document.getElementById('cart-total').innerText = total.toFixed(2) + " €";

            if (cart.length === 0) {
                emptyState.classList.remove('hidden');
                content.classList.add('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            content.classList.remove('hidden');
            content.classList.add('flex');

            container.innerHTML = cart.map(item => `
                <div class="flex gap-4 p-4 bg-white rounded-lg border border-slate-100 items-center">
                    <div class="w-20 h-20 bg-slate-50 rounded-md flex-shrink-0 flex items-center justify-center overflow-hidden">
                        <img src="${item.img}" alt="${item.title}" onerror="this.onerror=null;this.src=getFallbackImage('Photo produit');" class="w-full h-full object-contain">
                    </div>
                    <div class="flex-grow">
                        <h4 class="font-medium text-slate-900 text-sm line-clamp-1">${item.title}</h4>
                        <p class="text-xs text-slate-500 mb-2">Ref: PTY-${item.id}</p>
                        <div class="flex items-center gap-3">
                            <div class="flex items-center border border-slate-200 rounded-md">
                                <button onclick="updateQty(${item.id}, -1)" class="px-2 py-1 hover:bg-slate-50 text-slate-500">-</button>
                                <span class="px-2 text-xs font-medium text-slate-900">${item.qty}</span>
                                <button onclick="updateQty(${item.id}, 1)" class="px-2 py-1 hover:bg-slate-50 text-slate-500">+</button>
                            </div>
                            <button onclick="removeFromCart(${item.id})" class="text-xs text-red-500 hover:underline">Supprimer</button>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="font-bold text-slate-900">${(item.price * item.qty).toFixed(2)} €</span>
                    </div>
                </div>
            `).join('');
        }

        function showToast(message) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast bg-slate-900 text-white px-4 py-3 rounded-lg shadow-xl text-sm font-medium flex items-center gap-2 border border-slate-700';
            toast.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-400"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg> ${message}`;
            
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        const emailConfig = {
            enabled: false,
            shopEmail: 'contact@partifymoto.fr',
            emailjsPublicKey: '',
            emailjsServiceId: '',
            emailjsTemplateCustomerId: '',
            emailjsTemplateMerchantId: ''
        };

        async function sendOrderEmails(orderPayload) {
            if (!emailConfig.enabled) return { ok: false, reason: 'EmailJS non configuré' };
            const endpoint = 'https://api.emailjs.com/api/v1.0/email/send';

            const customerBody = {
                service_id: emailConfig.emailjsServiceId,
                template_id: emailConfig.emailjsTemplateCustomerId,
                user_id: emailConfig.emailjsPublicKey,
                template_params: {
                    to_email: orderPayload.customer.email,
                    customer_name: orderPayload.customer.name,
                    order_id: orderPayload.id,
                    order_total: orderPayload.total,
                    order_items: orderPayload.itemsSummary,
                    delivery_delay: orderPayload.maxDelivery
                }
            };

            const merchantBody = {
                service_id: emailConfig.emailjsServiceId,
                template_id: emailConfig.emailjsTemplateMerchantId,
                user_id: emailConfig.emailjsPublicKey,
                template_params: {
                    to_email: emailConfig.shopEmail,
                    order_id: orderPayload.id,
                    customer_name: orderPayload.customer.name,
                    customer_email: orderPayload.customer.email,
                    customer_phone: orderPayload.customer.phone || '-',
                    customer_address: orderPayload.customer.address,
                    order_total: orderPayload.total,
                    order_items: orderPayload.itemsSummary
                }
            };

            await fetch(endpoint, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(customerBody) });
            await fetch(endpoint, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(merchantBody) });
            return { ok: true };
        }

        function openCheckoutModal() {
            if (cart.length === 0) return;
            document.getElementById('checkout-shop-email').innerText = emailConfig.shopEmail;
            document.getElementById('checkout-modal').classList.remove('hidden');
            document.getElementById('checkout-modal').classList.add('flex');
        }

        function closeCheckoutModal() {
            document.getElementById('checkout-modal').classList.add('hidden');
            document.getElementById('checkout-modal').classList.remove('flex');
        }

        async function confirmOrder(e) {
            e.preventDefault();
            if (cart.length === 0) return;

            const customer = {
                name: document.getElementById('order-name').value.trim(),
                email: document.getElementById('order-email').value.trim(),
                phone: document.getElementById('order-phone').value.trim(),
                address: document.getElementById('order-address').value.trim()
            };

            const total = cart.reduce((acc, item) => acc + (item.price * item.qty), 0).toFixed(2) + ' €';
            const orderId = 'PM-' + Date.now();
            const maxDelivery = cart.map(item => item.delivery || '').join(' | ');
            const itemsSummary = cart.map(item => `${item.title} x${item.qty}`).join(', ');
            const orderPayload = {
                id: orderId,
                customer,
                total,
                items: cart,
                itemsSummary,
                maxDelivery,
                createdAt: new Date().toISOString()
            };

            const existingOrders = JSON.parse(localStorage.getItem('orders') || '[]');
            existingOrders.push(orderPayload);
            localStorage.setItem('orders', JSON.stringify(existingOrders));

            let emailMessage = 'Commande enregistrée.';
            try {
                const mailResult = await sendOrderEmails(orderPayload);
                if (mailResult.ok) emailMessage = 'Emails client + boutique envoyés.';
                else emailMessage = 'Commande enregistrée (emails en mode local à configurer).';
            } catch (err) {
                emailMessage = 'Commande enregistrée (erreur email, vérifier EmailJS).';
            }

            showToast(`Commande ${orderId} validée. ${emailMessage}`);
            closeCheckoutModal();
            document.getElementById('checkout-form').reset();
            cart = [];
            updateCartCounter();
            renderCartPage();
        }

        function checkout() {
            openCheckoutModal();
        }



        function exportSupplierJson() {
            const payload = db.products.map((p) => ({
                id: p.id,
                title: p.title,
                supplier: p.supplier,
                supplierUrl: p.supplierUrl,
                supplierProductUrl: p.supplierProductUrl || p.supplierUrl,
                supplierSku: p.supplierSku,
                delivery: p.delivery,
                image: p.img,
                price: p.price,
                cost: p.cost
            }));
            const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'partify-suppliers.json';
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
            showToast('Export fournisseurs JSON généré');
        }

        function exportShopifyCsv() {
            const headers = ['Handle','Title','Body (HTML)','Vendor','Type','Variant Price','Image Src','Status'];
            const rows = [headers.join(',')];
            db.products.forEach((p) => {
                const handle = p.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
                const body = `${p.desc} | Fournisseur: ${p.supplier} | Délai: ${p.delivery}`.replace(/"/g, '""');
                const row = [
                    handle,
                    `"${p.title.replace(/"/g, '""')}"`,
                    `"${body}"`,
                    `"${(p.supplier || 'Partify').replace(/"/g, '""')}"`,
                    `"${p.category}"`,
                    p.price,
                    `"${p.img}"`,
                    'active'
                ];
                rows.push(row.join(','));
            });
            const csv = rows.join('\n');
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'partify-shopify-products.csv';
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
            showToast('Export Shopify CSV généré');
        }

        function resetFilters() {
            activeCategory = 'all';
            document.getElementById('global-search').value = '';
            renderCatalog();
        }
    </script>

</body></html>
